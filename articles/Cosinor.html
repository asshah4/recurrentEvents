<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>cosinor • card</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="cosinor">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">card</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="external-link nav-link" href="https://shah-in-boots.github.io/"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Cosinor.html">cosinor</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/shah-in-boots/card/"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>cosinor</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/shah-in-boots/card/blob/main/vignettes/Cosinor.Rmd" class="external-link"><code>vignettes/Cosinor.Rmd</code></a></small>
      <div class="d-none name"><code>Cosinor.Rmd</code></div>
    </div>

    
    
<p>The function <code><a href="../reference/cosinor.html">cosinor()</a></code> is built off of literature
supporting the analysis of circadian rhythms. There are two other
packages on CRAN that provide cosinor analyses that are very good, <a href="https://CRAN.R-project.org/package=cosinor" class="external-link">cosinor</a> and <a href="https://CRAN.R-project.org/package=cosinor2" class="external-link">cosinor2</a>. This
package was built for 1) learning about regression and model
development, and 2) the raw material generated to allow for more
expansive and experimental analysis of cosinor functions and circadian
rhythms.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=card" class="external-link">card</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Using the provide dataset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"twins"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">twins</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 23</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   patid, hour [6]</span></span></span>
<span><span class="co">#&gt;   patid   age   bmi race  smoking hptn  dm    chf   prevchd med_beta_blockers</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1    49  27.4 0     1       1     0     0     0       0                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1    49  27.4 0     1       1     0     0     0       0                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1    49  27.4 0     1       1     0     0     0       0                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1    49  27.4 0     1       1     0     0     0       0                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1    49  27.4 0     1       1     0     0     0       0                </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     1    49  27.4 0     1       1     0     0     0       0                </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 13 more variables: med_antidepr &lt;fct&gt;, beck_total &lt;dbl&gt;, sad_bin &lt;fct&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   sad_cat &lt;fct&gt;, PETdiff_2 &lt;fct&gt;, dyxtime &lt;dttm&gt;, date &lt;date&gt;, hour &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   rDYX &lt;dbl&gt;, sDYX &lt;dbl&gt;, HR &lt;dbl&gt;, CP &lt;dbl&gt;, zip &lt;chr&gt;</span></span></span></code></pre></div>
<p>The <code>twins</code> dataset contains clinical covariates and
continuous time measures, such as heart rate variability at each hour of
the day. These continuous measures follow a circadian pattern.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">twins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">hour</span>, y <span class="op">=</span> <span class="va">rDYX</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"gam"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
<p><img src="Cosinor_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Cosinor analysis can be used to generate model statistics. Confidence
intervals of the amplitude and acrophase can be generated. It is based
of the <code>hardhat</code> package.</p>
<p>The model can return information about an individual cosinor. The
model statistics can be extracted, as well as visualized.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.html">cosinor</a></span><span class="op">(</span><span class="va">rDYX</span> <span class="op">~</span> <span class="va">hour</span>, data <span class="op">=</span> <span class="va">twins</span>, tau <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; Individual Cosinor Model </span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; cosinor(formula = rDYX ~ M + A1 * cos(2*pi*hour/24 + phi1) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Period(s): 24 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals: </span></span>
<span><span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span><span class="co">#&gt; -3.12633 -0.53228 -0.03597  0.00000  0.49132  4.82150 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;         Estimate  Std. Error</span></span>
<span><span class="co">#&gt; mesor  2.8604855 0.006098624</span></span>
<span><span class="co">#&gt; amp1   0.2986101 0.008746706</span></span>
<span><span class="co">#&gt; phi1  -2.6687044 0.028860014</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="../reference/ggcosinor.html">ggcosinor</a></span><span class="op">(</span><span class="va">m</span>, labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in regularize.values(x, y, ties, missing(ties)): collapsing to unique</span></span>
<span><span class="co">#&gt; 'x' values</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
<p><img src="Cosinor_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>More complex models can also be made using multiple components, which
is represented by additional, user-defined periods.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.html">cosinor</a></span><span class="op">(</span><span class="va">rDYX</span> <span class="op">~</span> <span class="va">hour</span>, data <span class="op">=</span> <span class="va">twins</span>, tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; Individual Cosinor Model </span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; cosinor(formula = rDYX ~ M + A1 * cos(2*pi*hour/24 + phi1) + A2 * cos(2*pi*hour/12 + phi2) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Period(s): 24, 12 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals: </span></span>
<span><span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span><span class="co">#&gt; -3.00770 -0.52024 -0.03247  0.00000  0.48753  4.88552 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients: </span></span>
<span><span class="co">#&gt;         Estimate  Std. Error</span></span>
<span><span class="co">#&gt; mesor  2.8586510 0.006062639</span></span>
<span><span class="co">#&gt; amp1   0.2964114 0.008702368</span></span>
<span><span class="co">#&gt; amp2   0.1302012 0.008542526</span></span>
<span><span class="co">#&gt; phi1  -2.6542757 0.028911445</span></span>
<span><span class="co">#&gt; phi2  -3.6636921 0.065235427</span></span>
<span></span>
<span><span class="co"># Plot</span></span>
<span><span class="fu"><a href="../reference/ggcosinor.html">ggcosinor</a></span><span class="op">(</span><span class="va">m</span>, labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; This is a harmonic multiple-component cosinor object. The orthophase, bathyphase, and global amplitude were calculated.</span></span>
<span><span class="co">#&gt; Warning in regularize.values(x, y, ties, missing(ties)): collapsing to unique</span></span>
<span><span class="co">#&gt; 'x' values</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ s(x, bs = "cs")'</span></span></code></pre></div>
<p><img src="Cosinor_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>And, these models can be repeated for an entire population if
warranted.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cosinor.html">cosinor</a></span><span class="op">(</span><span class="va">rDYX</span> <span class="op">~</span> <span class="va">hour</span>, data <span class="op">=</span> <span class="va">twins</span>, tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span><span class="op">)</span>, population <span class="op">=</span> <span class="st">"patid"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 18 subjects were removed due to having insufficient observations.</span></span>
<span></span>
<span><span class="co"># Summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt; Population Cosinor Model </span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt; Call: </span></span>
<span><span class="co">#&gt; cosinor(formula = rDYX ~ M + A1 * cos(2*pi*hour/24 + phi1) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Period(s): 24 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals: </span></span>
<span><span class="co">#&gt;     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. </span></span>
<span><span class="co">#&gt; -2.27890 -0.31508 -0.02126  0.00000  0.29324  3.93566 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; Confidence intervals for amplitude and acrophase for population-mean cosinor use the methods described by Fernando et al 2004, which may not be applicable to multiple-components.</span></span>
<span><span class="co">#&gt;         Estimate Std. Error</span></span>
<span><span class="co">#&gt; mesor  2.8248529 0.02497310</span></span>
<span><span class="co">#&gt; amp1   0.2880224 0.01661657</span></span>
<span><span class="co">#&gt; phi1  -2.7924872 0.04034663</span></span></code></pre></div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Anish S. Shah.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0. Colorspace from the <strong>BurgYl</strong> palette</p>
</div>

    </footer>
</div>





  </body>
</html>
